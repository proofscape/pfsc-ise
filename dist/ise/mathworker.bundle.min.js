/*! For license information please see mathworker.bundle.min.js.LICENSE.txt */
(()=>{var e={75493:e=>{e.exports=function(e,t,r,s){this.loaderVersion="1.16.4",function(e,t){var r=function(){return void 0!==h&&"function"!=typeof h?h:void 0!==s?s:"undefined"!=typeof self?self:this}(),n=function(){},i={}.toString,o=function(e){return"[object Function]"==i.call(e)},a=function(e){return"[object String]"==i.call(e)},u=function(e,t){if(e)for(var r=0;r<e.length;)t(e[r++])},c=function(e,t){for(var r in t)e[r]=t[r];return e},d=1,l=function(e,t,r){return(void 0)(e,t,r,0,l)},h=r,f=h.document,p=f&&f.createElement("DiV"),m=l.has=function(e){return o(g[e])?g[e]=g[e](h,f,p):g[e]},g=m.cache=t.hasCache;for(var y in o(e)&&(e=e(r)),m.add=function(e,t,r,s){return(void 0===g[e]||s)&&(g[e]=t),r&&m(e)},e.has)m.add(y,e.has[y],0,1);l.async=1;l.eval=function(e,t){};var b,v={},w=l.signal=function(e,t){var r=v[e];u(r&&r.slice(0),(function(e){var r;e.apply(null,(r=t,"[object Array]"==i.call(r)?t:[t]))}))},x=l.on=function(e,t){var r=v[e]||(v[e]=[]);return r.push(t),{remove:function(){for(var e=0;e<r.length;e++)if(r[e]===t)return void r.splice(e,1)}}},k=[],P={},M=[],_={},j=l.map={},E=[],q={},R="",N=function(e){return e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,(function(e){return"\\"+e}))},T=function(e,t){for(var r in t.splice(0,t.length),e)t.push([r,e[r],new RegExp("^"+N(r)+"(/|$)"),r.length]);return t.sort((function(e,t){return t[3]-e[3]})),t},H=function(e){var t=e.name;t||(e={name:t=e}),(e=c({main:"main"},e)).location=e.location?e.location:t,e.packageMap&&(j[t]=e.packageMap),e.main.indexOf("./")||(e.main=e.main.substring(2)),_[t]=e},O=function(e,t,r){for(var s in e)"waitSeconds"==s&&(l.waitms=1e3*(e[s]||0)),"cacheBust"==s&&(R=e[s]?a(e[s])?e[s]:(new Date).getTime()+"":""),"baseUrl"!=s&&"combo"!=s||(l[s]=e[s]),e[s]!==g&&(l.rawConfig[s]=e[s],"has"!=s&&m.add("config-"+s,e[s],0,t));for(s in l.baseUrl||(l.baseUrl="./"),/\/$/.test(l.baseUrl)||(l.baseUrl+="/"),e.has)m.add(s,e.has[s],0,t);for(var n in u(e.packages,H),e.packagePaths)u(e.packagePaths[n],(function(e){var t=n+"/"+e;a(e)&&(e={name:e}),e.location=t,H(e)}));T(c(j,e.map),E),u(E,(function(e){e[1]=T(e[1],[]),"*"==e[0]&&(E.star=e)})),T(c(P,e.paths),M),function(e,t){u(e,(function(e){t.push([a(e[0])?new RegExp("^"+N(e[0])+"$"):e[0],e[1]])}))}(e.aliases,k),w("config",[e,l.rawConfig])};l.rawConfig={},O(t,1),O(e,1),O({},1);var S=function(e,t){if(t)for(var r=0;r<t.length;r++)if(t[r][2].test(e))return t[r];return 0},A=function(e){var t,r,s=[];for(e=e.replace(/\\/g,"/").split("/");e.length;)".."==(t=e.shift())&&s.length&&".."!=r?(s.pop(),r=s[s.length-1]):"."!=t&&s.push(r=t);return s.join("/")},C=function(e,t,r,s){return{pid:e,mid:t,pack:r,url:s,executed:0,def:0}},I=function(e,t,r,s,n,i,a,d,l,h){var f,p,m,g,y,v,w,x;if(w=/^\./.test(e),/(^\/)|(\:)|(\.js$)/.test(e)||w&&!t)return C(0,e,0,e);if(e=A(w?t.mid+"/../"+e:e),/^\./.test(e))throw x=e,c(new Error("irrationalPath"),{src:"dojoLoader",info:x});h||w||!i.star||(g=S(e,i.star[1])),!g&&t&&(g=(g=S(t.mid,i))&&S(e,g[1])),g&&(e=g[1]+e.substring(g[3])),(p=r[f=(b=e.match(/^([^\/]+)(\/(.+))?$/))?b[1]:""])?e=f+"/"+(m=b[3]||p.main):f="";var k=0;return u(d,(function(t){var r=e.match(t[0]);r&&r.length>0&&(k=o(t[1])?e.replace(t[0],t[1]):t[1])})),k?I(k,0,r,s,n,i,a,d,l):(v=s[e])?l?C(v.pid,v.mid,v.pack,v.url):s[e]:(y=(g=S(e,a))?g[1]+e.substring(g[3]):f?("/"===p.location.slice(-1)?p.location.slice(0,-1):p.location)+"/"+m:e,/(^\/)|(\:)/.test(y)||(y=n+y),C(f,e,p,A(y+=".js")))},U=function(e,t,r){return I(e,t,_,q,l.baseUrl,E,M,k,void 0,r)},B=(l.toAbsMid=function(e,t){return U(e,t).mid},l.toUrl=function(e,t){var r=U(e+"/x",t),s=r.url;return B(0===r.pid?e:s.substring(0,s.length-5))},"function"==typeof e.fixupUrl?e.fixupUrl:function(e){return(e+="")+(R?(/\?/.test(e)?"&":"?")+R:"")});l.log=n,l.trace=n;var $=n;c(c(l,t.loaderPatch),e.loaderPatch),x("error",(function(e){try{if(console.error(e),e instanceof Error){for(var t in e)console.log(t+":",e[t]);console.log(".")}}catch(e){}})),c(l,{uid:function(){return"_"+d++},cache:{},packs:_}),h.define||(h.define=$,h.require=l)}.call(this,e,t)}}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,r),i.exports}!function(){function e(e,t){return c.require.toUrl(e,t)}function s(e,t){return c.require.toAbsMid(e,t)}function n(e,t,r){return a(e,t,r,0,n)}function i(e){for(var t in e)n.absMids[t]=e[t],n.absMidsById[e[t]]||(n.absMidsById[e[t]]=t)}function o(e,i,o,a){var u;if((e=e.split("!").map((function(e){return"."!==e.charAt(0)||i?s(e,i?{mid:i}:null):e})).join("!"))in n.absMids&&r.m[n.absMids[e]])if(o){var c=t[n.absMids[e]];u=c&&(a?c:c.exports)}else u=r(n.absMids[e]);if(!u)throw new Error("Module not found: "+e);return u}function a(e,t,r,s,n){var i={}.toString.call(e);if("[object String]"===i){var a=o(e,s,!(!1===r));if("object"==typeof a&&a.__DOJO_WEBPACK_DEFINE_PROMISE__)throw new Error("Module not found: "+e);return a}if("[object Object]"===i)throw new Error("Require config is not supported by WebPack");if("[object Array]"===i){var u=[],c=t,d=[];if(e.forEach((function(e){try{u.push(o(e,s))}catch(t){d.push({mid:e,error:t})}})),0===d.length)c&&c.apply(this,u);else{var l=new Error("findModules");l.src="dojo-webpack-plugin",l.info=d,n.signal("error",l)}return n}throw new Error("Unsupported require call")}n.toUrl=e,n.toAbsMid=s,n.absMids={},n.absMidsById=[],n.async=1;var u=this||window;if(i({}),u.require=n,(self.webpackChunkpfsc_ise=self.webpackChunkpfsc_ise||[]).registerAbsMids=i,r.dj&&"dojo-webpack-plugin"!==r.dj.name)throw new Error("__webpack_require__.dj name collision.");r.dj={name:"dojo-webpack-plugin",r:n,c:function(t){if(!t)return n;var r=t.absMid;if(!r&&n.absMidsById[t.id]&&(r=n.absMidsById[t.id]),!r)return n;var i=function(e,t,s){return a(e,t,s,r,n)};for(var o in n)n.hasOwnProperty(o)&&(i[o]=n[o]);return i.toUrl=function(t){return e(t,r?{mid:r}:null)},i.toAbsMid=function(e){return s(e,r?{mid:r}:null)},n.undef&&(i.undef=function(e){n.undef(e,r)}),i},m:function(e){if(e.absMid)return e;var t={i:e.id},r=n.absMidsById[e.id];return r&&(t.id=t.absMid=r),Object.defineProperty(t,"exports",{get:function(){return e.exports},set:function(t){e.exports=t},enumerable:!0,configurable:!0}),t},h:function(e){var t=o("dojo/has",null,!1).normalize(e,(function(e){return e}));return t&&r(t)||void 0}};var c=Object.create(u,{document:{value:u.document}});Object.defineProperties(c,{window:{value:c},global:{value:c}}),c.define=c.require=void 0,u.dojoConfig=u.dojoConfig||{};var d=function(e,t){for(var r in t)e[r]=t[r];return e}(u.dojoConfig,{packages:[{name:"dojo",location:"static/dojo"},{name:"dijit",location:"static/dijit"},{name:"dojox",location:"static/dojox"}],paths:{ise:"src"}});function s(e,t){var r=c.require.originalToAbsMid(e,t);if(r.indexOf("/")===r.length-1){var s=r.substring(0,r.length-1),n=c.require.packs[s];n&&n.realMain&&(r=s)}return r}function e(e,t){var r=c.require.originalToUrl(e,t),s=c.require.packs[e];if(s&&s.realMain){var n=r.split("?");/(^\/)|(\:)/.test(s.realMain)?n[0]=s.realMain:n[0]=n[0]+"/"+s.realMain,r=n.join("?")}return r}r(75493).call(c,d,{hasCache:{webpack:1,"host-browser":1,dom:1,"dojo-loader":1,"dojo-has-api":1,"dojo-dom-ready-api":1,"dojo-sniff":1,"dojo-test-sniff":1,"config-deferredInstrumentation":1,"config-tlmSiblingOfDojo":1}},c,c),Object.keys(c.require.packs).forEach((function(e){var t=c.require.packs[e];(/(^\/)|(\:)/.test(t.main)||t.main.split("/").reduce((function(e,t){return e<0||"."===t?e:".."===t?--e:++e}),0)<=0)&&void 0===t.realMain&&(t.realMain=t.main,t.main="")})),c.require.originalToAbsMid=c.require.toAbsMid,c.require.originalToUrl=c.require.toUrl,c.require.toAbsMid=s,c.require.toUrl=e,["baseUrl","has","rawConfig","on","signal"].forEach((function(e){n[e]=c.require[e]}));var l=u.webpackChunkpfsc_ise.absMidsWaiting;l&&(l.forEach(i),delete u.webpackChunkpfsc_ise.absMidsWaiting)}(),(()=>{"use strict";class e extends Error{constructor({message:e}){super(e),this.name="NoGroupError"}serialize(){return JSON.stringify({_error_class_name:this.name,message:this.message})}}class t extends Error{constructor({message:e}){super(e),this.name="ExtensionUnavailableError"}serialize(){return JSON.stringify({_error_class_name:this.name,message:this.message})}}class r extends Error{constructor({message:e}){super(e),this.name="UnknownPeerError"}serialize(){return JSON.stringify({_error_class_name:this.name,message:this.message})}}class s extends Error{constructor({url:e}){super(`Extension lacks host permission for ${e}.`),this.name="LackingHostPermissionError",this.url=e}serialize(){return JSON.stringify({_error_class_name:this.name,url:this.url})}}class n extends Error{constructor({ok:e,status:t,statusText:r,type:s,url:n,headers:i,contentType:o}){if(super(`Fetch ${n} status: ${t} ${r}`),this.name="FetchError",this.ok=e,this.status=t,this.statusText=r,this.type=s,this.url=n,this.contentType=o,i&&i.get)try{this.contentType=i.get("Content-Type")}catch(e){}}serialize(){return JSON.stringify({_error_class_name:this.name,ok:this.ok,status:this.status,statusText:this.statusText,type:this.type,url:this.url,contentType:this.contentType})}}const i=(new Map).set("FetchResolvedNotOkError",class extends n{constructor({ok:e,status:t,statusText:r,type:s,url:n}){super({ok:e,status:t,statusText:r,type:s,url:n}),this.name="FetchResolvedNotOkError"}}).set("FetchRejectedError",class extends n{constructor({ok:e,status:t,statusText:r,type:s,url:n}){super({ok:e,status:t,statusText:r,type:s,url:n}),this.name="FetchRejectedError",this.message="Fetch rejected. "+this.message}}).set("NoGroupError",e).set("ExtensionUnavailableError",t).set("LackingHostPermissionError",s).set("FetchWrongContentTypeError",class extends n{constructor({ok:e,status:t,statusText:r,type:s,url:n,headers:i,contentType:o}){super({ok:e,status:t,statusText:r,type:s,url:n,headers:i,contentType:o}),this.name="FetchWrongContentTypeError",this.message=`Fetch ${n} received unexpected Content-Type: ${o}`}}).set("UnknownPeerError",r),o=["micropip","Jinja2","mpmath"],a=["import pfsc_examp"];class u{constructor(e){this.uid=e,this.pyProxiesByPaneId=new Map}addPyProxy(e,t){this.pyProxiesByPaneId.set(e,t)}getPyProxyCopy(e){return this.pyProxiesByPaneId.get(e).copy()}getNumProxies(){return this.pyProxiesByPaneId.size}destroyProxy(e){const t=this.pyProxiesByPaneId.get(e);t&&(t.destroy(),this.pyProxiesByPaneId.delete(e))}}self.pfscisehub={notesManager:new class{constructor(){this.widgets=new Map}getWidget(e){return this.widgets.get(e)}ensureWidget(e){if(this.widgets.has(e))return this.widgets.get(e);{const t=new u(e);return this.widgets.set(e,t),t}}deleteWidget(e){this.widgets.delete(e)}}};const c=new class extends class extends class{constructor(e){this.listeners=e}on(e,t){const r=this.listeners[e]||[];r.push(t),this.listeners[e]=r}off(e,t){const r=this.listeners[e]||[],s=r.indexOf(t);s>=0&&(r.splice(s,1),this.listeners[e]=r)}dispatch(e){const t=(this.listeners[e.type]||[]).slice();for(let r of t)r(e)}}{constructor(e){super({}),this.constructionTime=(new Date).toLocaleTimeString(),this.name=e,this.handlers=new Map,this.nextSeqNum=0,this.requestsBySeqNum=new Map,this.reconstituteErrors=!1,this.readyResolve=null;const t=this;this.readyPromise=new Promise((e=>{t.readyResolve=e})),this.builtInHandlers=(new Map).set("ready",this.ready.bind(this));for(let[e,t]of this.builtInHandlers)this._addHandler(e,t)}fromAddress(){return this.name}copyMessage(e){return JSON.parse(JSON.stringify(e))}handleMessage(e){"request"===e.type?this.handleRequest(e):this.handleResponse(e)}handleRequest(e){const t=e.from,r=e.seqNum,s=e.handlerDescrip,n=e.args;let i;try{i=this.lookupHandler(s)}catch(e){return void this.returnRejection(t,r,e)}Promise.resolve(i(n,e)).then((e=>{this.returnResponse(t,r,e)})).catch((s=>{s=this.checkHandlingError(s,e),this.returnRejection(t,r,s)}))}returnResponse(e,t,r){const s={type:"response",from:this.fromAddress(),seqNum:t,result:r};this.postMessageAsPeer(e,s)}returnRejection(e,t,r){const s={type:"response",from:this.fromAddress(),seqNum:t,rejection_reason:r.message};this.postMessageAsPeer(e,s)}consumeRequestData(e){const t=this.requestsBySeqNum.get(e);return t&&window.clearTimeout(t.timeoutHandle),this.requestsBySeqNum.delete(e),t}handleResponse(e){const t=this.consumeRequestData(e.seqNum);if(t)if(e.rejection_reason){let r=new Error(e.rejection_reason);this.reconstituteErrors&&(r=function(e){let t=null;try{t=JSON.parse(e.message)}catch{}return t&&i.has(t._error_class_name)?new(i.get(t._error_class_name))(t):e}(r)),t.reject(r)}else t.resolve(e.result)}setReady(){this.readyResolve()}ready(){return this.readyPromise}checkReady(e){return this.makeRequest(e,"ready",{},!1)}addHandler(e,t){if(this.builtInHandlers.has(e))throw new Error(`Cannot register handler under reserved name: ${e}`);return this._addHandler(e,t),this}_addHandler(e,t){this.handlers.set(e,t)}_addBuiltInHandler(e,t){this.builtInHandlers.set(e,t),this._addHandler(e,t)}lookupHandler(e){const t=e.split(".");let r,s,n=!0;for(let e of t)if(n)n=!1,r=this.handlers.get(e);else{if(!r)break;s=r,r=r[e]}if(!r)throw new Error(`Unknown handler: ${e}`);if("function"!=typeof r)throw new Error(`Handler "${e}" is not a function`);return s&&(r=r.bind(s)),r}callHandler(e,t){return this.lookupHandler(e)(t)}takeNextSeqNum(){const e=this.nextSeqNum;return this.nextSeqNum=e+1,e}makeRequest(e,t,r,s){const{doReadyCheck:n=!1,timeout:i=0}=s||{},o=this.takeNextSeqNum(),a={type:"request",from:this.fromAddress(),seqNum:o,handlerDescrip:t,args:r};return(n?this.checkReady(e):Promise.resolve()).then((()=>new Promise(((t,r)=>{const s=i<1?null:window.setTimeout((()=>{this.consumeRequestData(o)&&r(new Error("Peer request timed out."))}),i);this.requestsBySeqNum.set(o,{resolve:t,reject:r,timeoutHandle:s}),this.postMessageAsPeer(e,a)}))))}broadcastRequest(e,t,r){const{excludeSelf:s=!1,filter:n=(()=>!0),skipReadyChecks:i=!1}=r||{},o=this.getAllPeerNames().filter((e=>!s||e!==this.name)).filter(n),a=[];for(let r of o)a.push(this.makeRequest(r,e,t,{doReadyCheck:!i}));return a}getAllPeerNames(){return[]}checkHandlingError(e,t){return e}postMessageAsPeer(e,t){}}{constructor(e){const[t,r]=e instanceof Worker?["page","worker"]:["worker","page"];super(t),this.nameOfPeer=r,this.iface=e,this.boundMessageHandler=this.handleMessageEvent.bind(this),this.activateMessaging()}terminate(){"worker"===this.nameOfPeer&&this.iface.terminate()}activateMessaging(){this.iface.onmessage=this.boundMessageHandler}handleMessageEvent(e){const t=e.data;super.handleMessage(t)}postMessageAsPeer(e,t){t.to=e,this.iface.postMessage(t)}postRequest(e,t,r){return this.makeRequest(this.nameOfPeer,e,t,r)}}(self);c.addHandler("echo",(function(e,t){return console.log("echo",e,t),"echoed"})),c.addHandler("ping",(function(e){return"pong"})),c.addHandler("startup",(function(e){self.pfscExampConfig=e.pfscExampConfig;let t=e.pyodideIndexURL;t.endsWith("/")||(t+="/"),importScripts(t+"pyodide.js");let r="import micropip\n";const s=e.micropipNoDeps?", deps=False":"";r+=`await micropip.install(${JSON.stringify(e.micropipInstallTargetsArray)}${s})\n`;for(let e of a)r+=`${e}\n`;return r+="{k:vars(v) for k, v in micropip.list().items()}\n",console.debug(r),self.pyoReady=new Promise((e=>{loadPyodide({indexURL:t}).then((t=>{self.pyodide=t,t.loadPackage(o).then((()=>{t.runPythonAsync(r).then((r=>{const s=r.toJs();r.destroy(),e({status:0,message:"loaded Pyodide and all packages",pyodideVersion:t.default||t.version,pkginfo:s})}))}))}))})),self.pyoReady})),c.addHandler("makePyProxy",(async function(e){await self.pyoReady;const t=e.info,r=e.paneId,s=t.uid,n=self.pfscisehub.notesManager.ensureWidget(s),i=self.pyodide.globals.get("pfsc_examp").make_examp_generator_obj_from_js,o=i(t,r);return i.destroy(),n.addPyProxy(r,o),n.getNumProxies()})),c.addHandler("destroyPyProxy",(function(e){const t=self.pfscisehub.notesManager,r=e.uid,s=e.paneId,n=t.getWidget(r);if(n){n.destroyProxy(s);const e=n.getNumProxies();return 0===e&&t.deleteWidget(r),e}return 0})),c.addHandler("rebuild",(async function(e){await self.pyoReady;const{uid:t,paneId:r,value:s=null,writeHtml:n=!1}=e,i=self.pfscisehub.notesManager.getWidget(t).getPyProxyCopy(r),o=self.pyodide.globals.get("pfsc_examp").rebuild_examp_generator_from_js,a=o.callKwargs(i,{value:s,write_html:n});return o.destroy(),Object.fromEntries(a)})),c.setReady()})()})();